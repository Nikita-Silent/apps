<!DOCTYPE html>
<html>
<head>
    <title>CUPS Printer Management</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>CUPS Printer Management</h1>
        <a href="/add-printer" class="btn btn-primary mb-3">Add Printer/Class</a>
        <a href="/logout" class="btn btn-secondary mb-3">Logout</a>
        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>URI</th>
                    <th>State</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for printer in printers %}
                    <tr>
                        <td><a href="/printer-detail/{{ printer.name }}">{{ printer.name }}</a></td>
                        <td>{{ printer.type | capitalize }}</td>
                        <td>{{ printer.uri }}</td>
                        <td>{{ printer.state }}</td>
                        <td>
                            <a href="/modify-printer/{{ printer.name }}" class="btn btn-info btn-sm">Modify</a>
                            <button class="btn btn-warning btn-sm pause-btn" data-name="{{ printer.name }}">Pause</button>
                            <button class="btn btn-success btn-sm resume-btn" data-name="{{ printer.name }}">Resume</button>
                            <button class="btn btn-danger btn-sm delete-btn" data-name="{{ printer.name }}">Delete</button>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <script>
        $(document).ready(function() {
            $('.pause-btn').click(function() {
                var name = $(this).data('name');
                $.post('/printers/' + name + '/pause', function(data) {
                    alert(data.message || data.error);
                    location.reload();
                });
            });
            $('.resume-btn').click(function() {
                var name = $(this).data('name');
                $.post('/printers/' + name + '/resume', function(data) {
                    alert(data.message || data.error);
                    location.reload();
                });
            });
            $('.delete-btn').click(function() {
                var name = $(this).data('name');
                if (confirm('Are you sure you want to delete ' + name + '?')) {
                    $.post('/printers/' + name + '/delete', function(data) {
                        alert(data.message || data.error);
                        location.reload();
                    });
                }
            });
        });
    </script>
</body>
</html>